<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Open HTTP Redirect | 0x5h1n0k0</title><meta name="author" content="0x5h1n0k0"><meta name="copyright" content="0x5h1n0k0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#100e17"><meta name="description" content="Open HTTP Redirect AboutOWASP define this as: Unvalidated redirects and forwards are possible when a web application accepts untrusted input that"><link rel="shortcut icon" href="/2/img/ava.png"><link rel="canonical" href="https://0x5h1n0k0.github.io/2/posts/1a450a05/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/2/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/2/',
  algolia: undefined,
  localSearch: {"path":"/2/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":300},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: 0x5h1n0k0","link":"Link: ","source":"Source: 0x5h1n0k0","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#bb86fc","bgDark":"#bb86fc","position":"bottom-center"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Open HTTP Redirect',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-09-23 15:00:25'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#100e17')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/2/css/cus.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/year.css"  media="defer" onload="this.media='all'"><script src="https://www.jq22.com/jquery/jquery-3.3.1.js"></script><script data-pjax src="/2/js/echarts.min.js"></script><script data-pjax src="/2/js/charts.js"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="/2/css/collapse.css">
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><style type="text/css">
.spoiler {
  display: inline-flex;
}
p.spoiler {
  display: flex;
}
.spoiler a {
  pointer-events: none;
}
.spoiler-blur, .spoiler-blur > * {
  transition: text-shadow .5s ease;
}
.spoiler .spoiler-blur, .spoiler .spoiler-blur > * {
  color: rgba(0, 0, 0, 0);
  background-color: rgba(0, 0, 0, 0);
  text-shadow: 0 0 10px grey;
  cursor: pointer;
}
.spoiler .spoiler-blur:hover, .spoiler .spoiler-blur:hover > * {
  text-shadow: 0 0 5px grey;
}
.spoiler-box, .spoiler-box > * {
  transition: color .5s ease,
  background-color .5s ease;
}
.spoiler .spoiler-box, .spoiler .spoiler-box > * {
  color: black;
  background-color: black;
  text-shadow: none;
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/2/img/shi-2.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/2/archives/"><div class="headline">Articles</div><div class="length-num">5</div></a><a href="/2/tags/"><div class="headline">Tags</div><div class="length-num">187</div></a><a href="/2/categories/"><div class="headline">Categories</div><div class="length-num">38</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/2/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/2/about/"><i class="fa-fw fa-regular fa-address-card"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/assets/141578891/22e8d3a4-81ba-4ddf-9a4f-cb6b66fe7ae8')"><nav id="nav"><span id="blog-info"><a href="/2/" title="0x5h1n0k0"><span class="site-name">0x5h1n0k0</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/2/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/2/about/"><i class="fa-fw fa-regular fa-address-card"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Open HTTP Redirect</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-09-23T06:21:16.997Z" title="Created 2023-09-23 13:21:16">2023-09-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-09-23T08:00:25.556Z" title="Updated 2023-09-23 15:00:25">2023-09-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/2/categories/DVWA/">DVWA</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">835</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>5mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Open HTTP Redirect"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><script src='https://unpkg.com/tippy.js@2.0.2/dist/tippy.all.min.js'></script>
<script src='/js/attachTooltips.js'></script>
<link rel='stylesheet' href='/css/tippy.css'>
<link rel="stylesheet" type="text&#x2F;css" href="https://cdn.jsdelivr.net/npm/hexo-tag-hint@0.3.1/dist/hexo-tag-hint.min.css"><div class="fnScope" scope="1"><h1 id="open-http-redirect"><a class="markdownIt-Anchor" href="#open-http-redirect"></a> <strong>Open HTTP Redirect</strong></h1><hr><h2 id="about"><a class="markdownIt-Anchor" href="#about"></a> <strong>About</strong></h2><p>OWASP define this as:</p><ul>
<li>Unvalidated redirects and forwards are possible when a web application accepts untrusted input that could cause the web application to redirect the request to a URL contained within untrusted input. By modifying untrusted URL input to a malicious site, an attacker may successfully launch a phishing scam and steal user credentials.</li>
</ul><p>As suggested above, a common use for this is to create a URL which initially goes to the real site but then redirects the victim off to a site controlled by the attacker. This site could be a clone of the target’s login page to steal credentials, a request for credit card details to pay for a service on the target site, or simply a spam page full of advertising.</p><h2 id="objective"><a class="markdownIt-Anchor" href="#objective"></a> <strong>Objective</strong></h2><p>Abuse the redirect page to move the user off the DVWA site or onto a different page on the site than expected.</p><blockquote>
<p>Ta sẽ dùng trang <a target="_blank" rel="noopener" href="https://google.com">https://google.com</a> để làm target của việc chuyển hướng.</p>
</blockquote><h2 id="security-level-low"><a class="markdownIt-Anchor" href="#security-level-low"></a> <strong>Security Level: Low</strong></h2><p>Source code</p><figure class="highlight php"><figcaption><span>title</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--<span class="number">8</span>&lt;-- <span class="string">"dvwa/open-http-redirect/sources/low.php"</span></span><br></pre></td></tr></tbody></table></figure><h3 id="analysis"><a class="markdownIt-Anchor" href="#analysis"></a> <strong>Analysis</strong></h3><p><img src="image.png" alt=""></p><p>Nhận thấy rằng, challenge cung cấp cho ta link của 2 Quote:</p><ul>
<li>Quote 1: <a target="_blank" rel="noopener" href="http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=1">http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=1</a></li>
<li>Quote 2: <a target="_blank" rel="noopener" href="http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=2">http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=2</a></li>
</ul><p>Tham số chính của url là <code>redirect</code>. Và trong đoạn code của challenge chỉ đề cập đến việc kiểm tra xem nếu tồn tại giá trị của <code>redirect</code> thì thực thi. Do đó ta có thể tiêm giá trị <a target="_blank" rel="noopener" href="https://google.com">https://google.com</a> vào tham số <code>redirect</code> để tiến hành chuyển hướng qua trang <a target="_blank" rel="noopener" href="http://google.com">google.com</a>.</p><h3 id="exploition"><a class="markdownIt-Anchor" href="#exploition"></a> <strong>Exploition</strong></h3><p>Như đã phân tích ở trên, payload đầy đủ của chúng ta là <code>http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=https://google.com</code></p><hr><h2 id="security-level-medium"><a class="markdownIt-Anchor" href="#security-level-medium"></a> <strong>Security Level: Medium</strong></h2><p>Source code</p><figure class="highlight php"><figcaption><span>title</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--<span class="number">8</span>&lt;-- <span class="string">"dvwa/open-http-redirect/sources/medium.php"</span></span><br></pre></td></tr></tbody></table></figure><h3 id="analysis-2"><a class="markdownIt-Anchor" href="#analysis-2"></a> <strong>Analysis</strong></h3><p>Ở challenge này, họ filter đầu vào bằng việc chặn sự xuất hiện của http:// và https://</p><p><img src="image-1.png" alt=""></p><h3 id="exploition-2"><a class="markdownIt-Anchor" href="#exploition-2"></a> <strong>Exploition</strong></h3><p>Bài này ta dùng <code>protocol-relative URL</code> (PRURL) để bypass và payload đầy đủ như dưới đây</p><blockquote>
<p>Payload: <a target="_blank" rel="noopener" href="http://localhost:4280/vulnerabilities/open_redirect/source/medium.php?redirect=//google.com">http://localhost:4280/vulnerabilities/open_redirect/source/medium.php?redirect=//google.com</a></p>
</blockquote><hr><h2 id="security-level-high"><a class="markdownIt-Anchor" href="#security-level-high"></a> <strong>Security Level: High</strong></h2><p>Source code</p><figure class="highlight php"><figcaption><span>title</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--<span class="number">8</span>&lt;-- <span class="string">"dvwa/open-http-redirect/sources/high.php"</span></span><br></pre></td></tr></tbody></table></figure><h3 id="analysis-3"><a class="markdownIt-Anchor" href="#analysis-3"></a> <strong>Analysis</strong></h3><p>Bài này họ dùng hàm <code>#!php strpos()</code> để kiểm tra xem chuỗi info.php có xuất hiện trong chuỗi được truyền vào tham số redirect hay không. Nếu không thì sẽ gửi thông báo <code>You can only redirect to the info page.</code> và sẽ không thành công trong việc redirect.</p><p>Bạn có thể dễ dàng nhận thấy thông qua URL dẫn đến Quote 1 hoặc URL dẫn đến Quote 2.</p><p><a target="_blank" rel="noopener" href="http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=1">http://localhost:4280/vulnerabilities/open_redirect/source/low.php?redirect=info.php?id=1</a></p><p>Để ý rằng, chuỗi info.php&amp;id=1 được truyền vào tham số redirect đã vô tình biến cho chuỗi <code>1</code> làm giá trị cho tham số <code>id</code>. Tóm lại ta cần redirect tới 1 website nào đó đủ “mạnh” để nó có thể filter những tham số lỗi. Như payload dưới đây.</p><blockquote>
<p><a target="_blank" rel="noopener" href="http://localhost:4280/vulnerabilities/open_redirect/source/high.php?redirect=https://google.com?info.php">http://localhost:4280/vulnerabilities/open_redirect/source/high.php?redirect=https://google.com?info.php</a></p>
</blockquote><hr><h2 id="security-level-impossible"><a class="markdownIt-Anchor" href="#security-level-impossible"></a> <strong>Security Level: Impossible</strong></h2><p>Source code</p><figure class="highlight php"><figcaption><span>title</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--<span class="number">8</span>&lt;-- <span class="string">"dvwa/open-http-redirect/sources/impossible.php"</span></span><br></pre></td></tr></tbody></table></figure><hr><h2 id="what-we-learned"><a class="markdownIt-Anchor" href="#what-we-learned"></a> <strong>What we learned</strong></h2><ol>
<li>PRURL: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/URL#prurl">https://en.wikipedia.org/wiki/URL#prurl</a></li>
</ol><h2 id="spoiler"><a class="markdownIt-Anchor" href="#spoiler"></a> <strong>Spoiler</strong></h2><h3 id="low-level"><a class="markdownIt-Anchor" href="#low-level"></a> <strong>Low Level</strong></h3><p>The redirect page has no limitations, you can redirect to anywhere you want.</p><p>Spoiler: Try browsing to /vulnerabilities/open_redirect/source/low.php?redirect=<a target="_blank" rel="noopener" href="https://digi.ninja">https://digi.ninja</a></p><h2 id="medium-level"><a class="markdownIt-Anchor" href="#medium-level"></a> <strong>Medium Level</strong></h2><p>The code prevents you from using absolute URLs to take the user off the site, so you can either use relative URLs to take them to other pages on the same site or a Protocol-relative URL.</p><p>Spoiler: Try browsing to /vulnerabilities/open_redirect/source/low.php?redirect=//digi.ninja</p><h2 id="high-level"><a class="markdownIt-Anchor" href="#high-level"></a> <strong>High Level</strong></h2><p>The redirect page tries to lock you to only redirect to the info.php page, but does this by checking that the URL contains “info.php”.</p><p>Spoiler: Try browsing to /vulnerabilities/open_redirect/source/low.php?redirect=<a target="_blank" rel="noopener" href="https://digi.ninja/?a=info.php">https://digi.ninja/?a=info.php</a></p><h2 id="impossible-level"><a class="markdownIt-Anchor" href="#impossible-level"></a> <strong>Impossible Level</strong></h2><p>Rather than accepting a page or URL as the redirect target, the system uses ID values to tell the redirect page where to redirect to. This ties the system down to only redirect to pages it knows about and so there is no way for an attacker to modify things to go to a page of their choosing.</p><h2 id="more-information"><a class="markdownIt-Anchor" href="#more-information"></a> <strong>More Information</strong></h2><ul>
<li><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/Unvalidated_Redirects_and_Forwards_Cheat_Sheet.html">OWASP Unvalidated Redirects and Forwards Cheat Sheet</a></li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/11-Client-side_Testing/04-Testing_for_Client-side_URL_Redirect">WSTG - Testing for Client-side URL Redirect</a></li>
<li><a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/601.html">Mitre - CWE-601: URL Redirection to Untrusted Site (‘Open Redirect’)</a></li>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Password_cracking">https://en.wikipedia.org/wiki/Password_cracking</a></li>
</ul></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://0x5h1n0k0.github.io/2">0x5h1n0k0</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://0x5h1n0k0.github.io/2/posts/1a450a05/">https://0x5h1n0k0.github.io/2/posts/1a450a05/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/2/tags/Open-HTTP-Redirect/">Open HTTP Redirect</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/2/img/shi-2.png" onerror="this.onerror=null;this.src='/2/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">0x5h1n0k0</div><div class="author-info__description">Nothing to show!</div></div><div class="card-info-data site-data is-center"><a href="/2/archives/"><div class="headline">Articles</div><div class="length-num">5</div></a><a href="/2/tags/"><div class="headline">Tags</div><div class="length-num">187</div></a><a href="/2/categories/"><div class="headline">Categories</div><div class="length-num">38</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/0x5h1n0k0"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#open-http-redirect"><span class="toc-number">1.</span> <span class="toc-text"> Open HTTP Redirect</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#about"><span class="toc-number">1.1.</span> <span class="toc-text"> About</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#objective"><span class="toc-number">1.2.</span> <span class="toc-text"> Objective</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#security-level-low"><span class="toc-number">1.3.</span> <span class="toc-text"> Security Level: Low</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#analysis"><span class="toc-number">1.3.1.</span> <span class="toc-text"> Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exploition"><span class="toc-number">1.3.2.</span> <span class="toc-text"> Exploition</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#security-level-medium"><span class="toc-number">1.4.</span> <span class="toc-text"> Security Level: Medium</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#analysis-2"><span class="toc-number">1.4.1.</span> <span class="toc-text"> Analysis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exploition-2"><span class="toc-number">1.4.2.</span> <span class="toc-text"> Exploition</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#security-level-high"><span class="toc-number">1.5.</span> <span class="toc-text"> Security Level: High</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#analysis-3"><span class="toc-number">1.5.1.</span> <span class="toc-text"> Analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#security-level-impossible"><span class="toc-number">1.6.</span> <span class="toc-text"> Security Level: Impossible</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#what-we-learned"><span class="toc-number">1.7.</span> <span class="toc-text"> What we learned</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spoiler"><span class="toc-number">1.8.</span> <span class="toc-text"> Spoiler</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#low-level"><span class="toc-number">1.8.1.</span> <span class="toc-text"> Low Level</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#medium-level"><span class="toc-number">1.9.</span> <span class="toc-text"> Medium Level</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#high-level"><span class="toc-number">1.10.</span> <span class="toc-text"> High Level</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#impossible-level"><span class="toc-number">1.11.</span> <span class="toc-text"> Impossible Level</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#more-information"><span class="toc-number">1.12.</span> <span class="toc-text"> More Information</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2/posts/1632e7c/" title="Hackthebox machines"><img src="/2/posts/1632e7c/hackthebox.png" onerror="this.onerror=null;this.src='/2/img/404.jpg'" alt="Hackthebox machines"/></a><div class="content"><a class="title" href="/2/posts/1632e7c/" title="Hackthebox machines">Hackthebox machines</a><time datetime="2023-11-24T11:11:33.000Z" title="Created 2023-11-24 18:11:33">2023-11-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2/posts/68cc253f/" title="0x5h1n0k0"><img src="/2/img/shi_be.jpg" onerror="this.onerror=null;this.src='/2/img/404.jpg'" alt="0x5h1n0k0"/></a><div class="content"><a class="title" href="/2/posts/68cc253f/" title="0x5h1n0k0">0x5h1n0k0</a><time datetime="2023-10-14T20:48:22.000Z" title="Created 2023-10-15 03:48:22">2023-10-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2/posts/67caa546/" title="Common Vulnerabilities and Exposures"><img src="/2/posts/67caa546/image.png" onerror="this.onerror=null;this.src='/2/img/404.jpg'" alt="Common Vulnerabilities and Exposures"/></a><div class="content"><a class="title" href="/2/posts/67caa546/" title="Common Vulnerabilities and Exposures">Common Vulnerabilities and Exposures</a><time datetime="2023-09-25T16:47:03.000Z" title="Created 2023-09-25 23:47:03">2023-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2/posts/c75098e/" title="TryHackMe"><img src="/2/posts/c75098e/image.png" onerror="this.onerror=null;this.src='/2/img/404.jpg'" alt="TryHackMe"/></a><div class="content"><a class="title" href="/2/posts/c75098e/" title="TryHackMe">TryHackMe</a><time datetime="2023-09-25T05:29:19.000Z" title="Created 2023-09-25 12:29:19">2023-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2/posts/a922f8e1/" title="Damn Vulnerable Web Application"><img src="https://github.com/0x5h1n0k0/0x5h1n0k0.github.io/assets/141578891/22e8d3a4-81ba-4ddf-9a4f-cb6b66fe7ae8" onerror="this.onerror=null;this.src='/2/img/404.jpg'" alt="Damn Vulnerable Web Application"/></a><div class="content"><a class="title" href="/2/posts/a922f8e1/" title="Damn Vulnerable Web Application">Damn Vulnerable Web Application</a><time datetime="2023-09-23T08:01:30.182Z" title="Created 2023-09-23 15:01:30">2023-09-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 By 0x5h1n0k0</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/2/js/utils.js"></script><script src="/2/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const abcjsInit = () => {
    const abcjsFn = () => {
      document.querySelectorAll(".abc-music-sheet").forEach(ele => {
        ABCJS.renderAbc(ele, ele.innerHTML, {responsive: 'resize'})
      })
    }
    
    typeof ABCJS === 'object' ? abcjsFn()
      : getScript('https://cdn.jsdelivr.net/npm/abcjs/dist/abcjs-basic-min.min.js').then(abcjsFn)
  }

  window.pjax ? abcjsInit() : window.addEventListener('load', abcjsInit)
})()</script><script>(()=>{
  const getGiscusTheme = theme => {
    return theme === 'dark' ? 'dark' : ''
  }

  const loadGiscus = () => {
    const config = Object.assign({
      src: 'https://giscus.app/client.js',
      'data-repo': '0x5h1n0k0/2',
      'data-repo-id': 'R_kgDOKXFugg',
      'data-category-id': 'DIC_kwDOKXFugs4CZryo',
      'data-mapping': 'pathname',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true
    },null)

    const ele = document.createElement('script')
    for (let key in config) {
      ele.setAttribute(key, config[key])
    }
    document.getElementById('giscus-wrap').appendChild(ele)
  }

  const changeGiscusTheme = theme => {
    const sendMessage = message => {
      const iframe = document.querySelector('iframe.giscus-frame')
      if (!iframe) return
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app')
    }

    sendMessage({
      setConfig: {
        theme: getGiscusTheme(theme)
      }
    });
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment= loadGiscus
  }
})()</script></div><script src="https://fastly.jsdelivr.net/gh/0x5h1n0k0/live2d-hexo@latest/autoload.js"></script><script src="https://0x5h1n0k0.github.io/assets/javascripts/cursor-effects.js"></script><script id="canvas_nest" defer="defer" color="187, 134, 252" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/2/js/search/local-search.js"></script></div></div><!-- hexo injector body_end start -->
<script src="/2/js/collapse.js"></script>
<script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>